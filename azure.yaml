# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: citadel-online-research-agent-vnet
metadata:
  template: citadel-online-research-agent-vnet@0.0.1-beta

infra:
  provider: bicep
  path: .
  parameters:
  createContainerApp: true
  # Pin deterministic suffix to match already-deployed resources (reuse instead of creating new)
  stableSuffix: 6jjr
  # Enable internal Container Apps DNS immediately with environment creation (set true to create zone/links)
  internalAcaDnsEnabled: true
  # Choose mode: auto discovers defaultDomain then creates internal.<defaultDomain> zone; explicit uses provided internalAcaDnsZoneName; none skips
  internalAcaDnsMode: auto
  # For explicit mode provide: internalAcaDnsZoneName: internal.<defaultDomain-from-first-deploy>
  # internalAcaDnsZoneName: ""
  # Additional VNets (resource IDs) to link to the internal ACA DNS zone (e.g., APIM VNet)
  additionalInternalAcaDnsVnetIds: []
  # Disable monitoring private endpoints until feature/permissions confirmed
  enableMonitoringPrivateEndpoints: false
  # APIM Integration (optional): set apimVnetResourceId to peer APIM VNet with primary VNet and (optionally) link DNS
  # apimVnetResourceId: /subscriptions/<subId>/resourceGroups/<rg>/providers/Microsoft.Network/virtualNetworks/<apimVnetName>
  createApimVnetPeering: true
  createApimReversePeering: false

pipeline:
  provider: github

## Service block removed for infra-first deployment (no local Docker required). Will reintroduce after remote ACR build.
